package com.zj198.action.loan;

import java.util.List;

import com.opensymphony.xwork2.ActionContext;
import com.zj198.action.BaseAction;
import com.zj198.model.PrdDatafileList;
import com.zj198.model.PrdFinance;
import com.zj198.model.PrdFinanceDatafile;
import com.zj198.model.UsrUser;
import com.zj198.model.vo.FinanceAreaModel;
import com.zj198.model.vo.FinanceIndustryModel;
import com.zj198.service.loan.FinanceProductService;
import com.zj198.service.loan.model.FinanceProductSpModel;

public class FinanceProductManaAction extends BaseAction{
	private FinanceProductService financeProductService;
	private List<PrdFinance> productList;
	private PrdFinance product;
	private Integer productId;
	private List<FinanceAreaModel> productAreaList;
	private List<FinanceIndustryModel> productIndustryList;
	private FinanceProductSpModel financeProductSpModel;
	private List<PrdDatafileList> dataFileList;
	
	public String execute() {
		return null;
	}
	
	/**
	 * 银行或其它贷款机构产品管理
	 * @return
	 */
	public String financeMana(){
		ActionContext context = ActionContext.getContext();
		UsrUser user = (UsrUser) context.getSession().get("_user");
		if(user == null){
			return ERROR;
		}
		productList = financeProductService.findFinanceByUser(user.getId());
		
		return "financeMana";
	}
	
	
	public String viewFinance(){
		product = financeProductService.getFinance(productId);
		productAreaList = financeProductService.findFiananceArea(productId);
		productIndustryList = financeProductService.findFiananceInducty(productId);
		
		if(product.getOtherRequire() != null){
			product.setOtherRequire(product.getOtherRequire().replaceAll("\r\n", "<br/>"));
		}
		if(product.getProIntroduce() != null){
			product.setProIntroduce(product.getProIntroduce().replaceAll("\r\n", "<br/>"));
		}
		if(product.getDataFiles() != null){			
			for(PrdFinanceDatafile df: product.getDataFiles()){
				if(df.getOtherMemo() != null){
					df.setOtherMemo(df.getOtherMemo().replaceAll("\r\n", "<br/>"));
				}
			}
		}
		
		
		return "view_finance";
	}
	
	public String updateStatus(){
		financeProductService.updateFinanceStatus(product);
		return "update_success";
	}

	public List<PrdFinance> getProductList() {
		return productList;
	}

	public void setProductList(List<PrdFinance> productList) {
		this.productList = productList;
	}

	public void setFinanceProductService(FinanceProductService financeProductService) {
		this.financeProductService = financeProductService;
	}

	public PrdFinance getProduct() {
		return product;
	}

	public void setProduct(PrdFinance product) {
		this.product = product;
	}

	public Integer getProductId() {
		return productId;
	}

	public void setProductId(Integer productId) {
		this.productId = productId;
	}

	public List<FinanceAreaModel> getProductAreaList() {
		return productAreaList;
	}

	public void setProductAreaList(List<FinanceAreaModel> productAreaList) {
		this.productAreaList = productAreaList;
	}

	public List<FinanceIndustryModel> getProductIndustryList() {
		return productIndustryList;
	}

	public void setProductIndustryList(
			List<FinanceIndustryModel> productIndustryList) {
		this.productIndustryList = productIndustryList;
	}

	public FinanceProductSpModel getFinanceProductSpModel() {
		return financeProductSpModel;
	}

	public void setFinanceProductSpModel(FinanceProductSpModel financeProductSpModel) {
		this.financeProductSpModel = financeProductSpModel;
	}

	public FinanceProductService getFinanceProductService() {
		return financeProductService;
	}

}
